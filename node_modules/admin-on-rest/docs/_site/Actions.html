<!DOCTYPE HTML>
<html lang="en-US">
    <head>
        <title>Admin-on-rest - Actions</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/syntax.css">
    </head>
    <body>
        <div class="book with-summary font-size-2 font-family-1">
            <div class="book-summary">
                <nav role="navigation">
                    <ul class="summary">
                        <li class="header">Table of Contents</li>
                        <li class="chapter ">
                            <a href="./index.html">
                                <b>1.</b> Read Me
                            </a>
                        </li>
                        <li class="chapter ">
                            <a href="./Tutorial.html">
                                <b>2.</b> Tutorial
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#installation">Installation</a>
                                </li>
                                <li class="chapter">
                                    <a href="#making-contact-with-the-api">Making Contact With The API</a>
                                </li>
                                <li class="chapter">
                                    <a href="#field-types">Field Types</a>
                                </li>
                                <li class="chapter">
                                    <a href="#relationships">Relationships</a>
                                </li>
                                <li class="chapter">
                                    <a href="#creation-and-edition">Creation and Edition</a>
                                </li>
                                <li class="chapter">
                                    <a href="#deletion">Deletion</a>
                                </li>
                                <li class="chapter">
                                    <a href="#filters">Filters</a>
                                </li>
                                <li class="chapter">
                                    <a href="#customizing-the-menu-icons">Customizing the Menu Icons</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-custom-home-page">Using a Custom Home Page</a>
                                </li>
                                <li class="chapter">
                                    <a href="#adding-a-login-page">Adding a Login Page</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-another-rest-dialect">Using Another REST Dialect</a>
                                </li>
                                <li class="chapter">
                                    <a href="#conclusion">Conclusion</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./RestClients.html">
                                <b>3.</b> REST Clients
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#simple-rest">Simple REST</a>
                                </li>
                                <li class="chapter">
                                    <a href="#jsonserver-rest">JSON Server REST</a>
                                </li>
                                <li class="chapter">
                                    <a href="#adding-custom-headers">Adding Custom Headers</a>
                                </li>
                                <li class="chapter">
                                    <a href="#third-party-clients">Third-Party Clients</a>
                                </li>
                                <li class="chapter">
                                    <a href="#writing-your-own-rest-client">Writing your own REST client</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./AdminResource.html">
                                <b>4.</b> Admin and Resource Components
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#the-admin-component"><code>&lt;Admin&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#the-resource-component"><code>&lt;Resource&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-admin-on-rest-without-admin-and-resource">Not using <code>&lt;Admin&gt;</code> and <code>&lt;Resource&gt;</code></a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./List.html">
                                <b>5.</b> The <code>&lt;List&gt;</code> View
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#the-list-component"><code>&lt;List&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#the-datagrid-component"><code>&lt;Datagrid&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#the-singlefieldlist-component"><code>&lt;SingleFieldList&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-custom-iterator">Using a Custom Iterator</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./Fields.html">
                                <b>6.</b> Field Components
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#booleanfield"><code>&lt;BooleanField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#chipfield"><code>&lt;ChipField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#datefield"><code>&lt;DateField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#emailfield"><code>&lt;EmailField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#functionfield"><code>&lt;FunctionField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#numberfield"><code>&lt;NumberField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#referencefield"><code>&lt;ReferenceField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#referencemanyfield"><code>&lt;ReferenceManyField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#richtextfield"><code>&lt;RichTextField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#textfield"><code>&lt;TextField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#urlfield"><code>&lt;UrlField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#styling-fields">Styling Fields</a>
                                </li>
                                <li class="chapter">
                                    <a href="#writing-your-own-field-component">Writing your own field component</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./CreateEdit.html">
                                <b>7.</b> The <code>&lt;Create&gt;</code> and <code>&lt;Edit&gt;</code> Views
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#the-create-and-edit-components"><code>&lt;Create&gt;</code>, <code>&lt;Edit&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#page-title">Page Title</a>
                                </li>
                                <li class="chapter">
                                    <a href="#actions">Actions</a>
                                </li>
                                <li class="chapter">
                                    <a href="#the-simpleform-component"><code>&lt;SimpleForm&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#the-tabbedform-component"><code>&lt;TabbedForm&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#default-values">Default Values</a>
                                </li>
                                <li class="chapter">
                                    <a href="#validation">Validation</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./Inputs.html">
                                <b>8.</b> Input Components
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#autocompleteinput"><code>&lt;AutocompleteInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#booleaninput-and-nullablebooleaninput"><code>&lt;BooleanInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#dateinput"><code>&lt;DateInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#disabledinput"><code>&lt;DisabledInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#longtextinput"><code>&lt;LongTextInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#numberinput"><code>&lt;NumberInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#radiobuttongroupinput"><code>&lt;RadioButtonGroupInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#referenceinput"><code>&lt;ReferenceInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#richtextinput"><code>&lt;RichTextInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#selectinput"><code>&lt;SelectInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#textinput"><code>&lt;TextInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#writing-your-own-input-component">Writing your own input component</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./Authentication.html">
                                <b>9.</b> Authentication
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#configuring-the-auth-client">Configuring the Auth Client</a>
                                </li>
                                <li class="chapter">
                                    <a href="#sending-credentials-to-the-rest-api">Sending Credentials to the REST API</a>
                                </li>
                                <li class="chapter">
                                    <a href="#adding-a-logout-button">Adding a Logout Button</a>
                                </li>
                                <li class="chapter">
                                    <a href="#checking-credentials-during-navigation">Checking Credentials During Navigation</a>
                                </li>
                                <li class="chapter">
                                    <a href="#customizing-the-login-and-logout-components">Customizing The Login and Logout Components</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./Theming.html">
                                <b>10.</b> Theming
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#overriding-a-component-style">Overriding A Component Style</a>
                                </li>
                                <li class="chapter">
                                    <a href="#conditional-formatting">Conditional Formatting</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-predefined-theme">Using a Predefined Theme</a>
                                </li>
                                <li class="chapter">
                                    <a href="#writing-a-custom-theme">Writing a Custom Theme</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-custom-layout">Using a Custom Layout</a>
                                </li>
                            </ul>
                        </li>

                        <li class="chapter active">
                            <a href="./Actions.html">
                                <b>11.</b> Writing Actions
                            </a>
                            <ul class="articles" >
                                <li class="chapter">
                                    <a href="#the-simple-way">The Simple Way</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-the-rest-client-instead-of-fetch">Using The REST Client</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-custom-action-creator">Using a Custom Action Creator</a>
                                </li>
                                <li class="chapter">
                                    <a href="#handling-side-effects-with-a-custom-saga">Handling Side Effects With a Custom Saga</a>
                                </li>
                                <li class="chapter">
                                    <a href="#bonus-optimistic-rendering">Bonus: Optimistic Rendering</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-custom-reducer">Using a Custom Reducer</a>
                                </li>
                            </ul>
                        </li>

                        <li class="chapter ">
                            <a href="./Translation.html">
                                <b>12.</b> Translation
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#changing-locale">Changing Locale</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-the-browser-locale">Using Browser Locale</a>
                                </li>
                                <li class="chapter">
                                    <a href="#translation-messages">Translation Messages</a>
                                </li>
                                <li class="chapter">
                                    <a href="#overriding-existing-translations">Overriding Existing Translations</a>
                                </li>
                                <li class="chapter">
                                    <a href="#translating-your-resources">Translating Your Resources</a>
                                </li>
                                <li class="chapter">
                                    <a href="#translating-your-own-components">Translating Your Own Components</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-specific-polyglot-features">Using Specific Polyglot Features</a>
                                </li>
                            </ul>
                        </li>

                        <li class="chapter ">
                            <a href="./CustomApp.html">
                                <b>13.</b> Including in Another App
                            </a>
                        </li>

                        <li class="chapter ">
                            <a href="./Reference.html">
                                <b>14.</b> Reference
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
            <div class="book-body">
                <div class="body-inner">
                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">

                            <div id="book-search-results">
                                <div class="search-noresults">

                                <section class="normal markdown-section">

                                <h1 id="writing-actions">Writing Actions</h1>

<p>Admin interfaces often have to offer custom actions, beyond the simple CRUD. For instance, in an administration for comments, an “Approve” button (allowing to update the <code class="highlighter-rouge">is_approved</code> property and to save the updated record in one click) - is a must have.</p>

<p>How can you add such custom actions with admin-on-rest? The answer is twofold, and learning to do it properly will give you a better understanding of how admin-on-rest uses Redux and redux-saga.</p>

<h2 id="the-simple-way">The Simple Way</h2>

<p>Here is an implementation of the “Approve” button that works perfectly:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/comments/ApproveButton.js</span>
<span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">PropTypes</span><span class="p">,</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">connect</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react-redux'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">FlatButton</span> <span class="nx">from</span> <span class="s1">'material-ui/FlatButton'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">showNotification</span> <span class="nx">as</span> <span class="nx">showNotificationAction</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">push</span> <span class="nx">as</span> <span class="nx">pushAction</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react-router-redux'</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">ApproveButton</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">handleClick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">push</span><span class="p">,</span> <span class="nx">record</span><span class="p">,</span> <span class="nx">showNotification</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">updatedRecord</span> <span class="o">=</span> <span class="p">{</span> <span class="p">...</span><span class="nx">record</span><span class="p">,</span> <span class="na">is_approved</span><span class="p">:</span> <span class="kc">true</span> <span class="p">};</span>
        <span class="nx">fetch</span><span class="p">(</span><span class="err">`</span><span class="o">/</span><span class="nx">comments</span><span class="o">/</span><span class="nx">$</span><span class="p">{</span><span class="nx">record</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="err">`</span><span class="p">,</span> <span class="p">{</span> <span class="na">method</span><span class="p">:</span> <span class="s1">'PUT'</span><span class="p">,</span> <span class="na">body</span><span class="p">:</span> <span class="nx">updatedRecord</span> <span class="p">})</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">showNotification</span><span class="p">(</span><span class="s1">'Comment approved'</span><span class="p">);</span>
                <span class="nx">push</span><span class="p">(</span><span class="s1">'/comments'</span><span class="p">);</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
                <span class="nx">showNotification</span><span class="p">(</span><span class="s1">'Error: comment not approved'</span><span class="p">,</span> <span class="s1">'warning'</span><span class="p">)</span>
            <span class="p">});</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">&lt;</span><span class="nx">FlatButton</span> <span class="nx">label</span><span class="o">=</span><span class="s2">"Approve"</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">;
</span>    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ApproveButton</span><span class="p">.</span><span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">push</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">,</span>
    <span class="na">record</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">object</span><span class="p">,</span>
    <span class="na">showNotification</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">,</span>
<span class="p">};</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">showNotification</span><span class="p">:</span> <span class="nx">showNotificationAction</span><span class="p">,</span>
    <span class="na">push</span><span class="p">:</span> <span class="nx">pushAction</span><span class="p">,</span>
<span class="p">})(</span><span class="nx">ApproveButton</span><span class="p">);</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge">handleClick</code> function makes a <code class="highlighter-rouge">PUT</code> request the REST API with <code class="highlighter-rouge">fetch</code>, then displays a notification (with <code class="highlighter-rouge">showNotification</code>) and redirects to the comments list page (with <code class="highlighter-rouge">push</code>);</p>

<p><code class="highlighter-rouge">showNotification</code> and <code class="highlighter-rouge">push</code> are <em>action creators</em>. This is a Redux term for functions that return a simple action object. However, within the component, these functions are a bit more than that: they are <em>connected</em>, i.e. they are decorated by Redux’ <code class="highlighter-rouge">dispatch</code> method. So in the <code class="highlighter-rouge">handleClick</code> function, a call to <code class="highlighter-rouge">showNotification()</code> is actually a call to <code class="highlighter-rouge">dispatch(showNotification())</code>. The decoration by <code class="highlighter-rouge">dispatch</code> is done in the final statement, <code class="highlighter-rouge">connect()</code>.</p>

<p>This <code class="highlighter-rouge">ApproveButton</code> can be used right away, for instance in the list of comments, where <code class="highlighter-rouge">&lt;Datagrid&gt;</code> automatically injects the <code class="highlighter-rouge">record</code> to its children:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/comments/index.js</span>
<span class="kr">import</span> <span class="nx">ApproveButton</span> <span class="nx">from</span> <span class="s1">'./ApproveButton'</span><span class="p">;</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">CommentList</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="o">&lt;</span><span class="nx">List</span> <span class="p">{...</span><span class="nx">props</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Datagrid</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">DateField</span> <span class="nx">source</span><span class="o">=</span><span class="s2">"created_at"</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="nx">TextField</span> <span class="nx">source</span><span class="o">=</span><span class="s2">"author.name"</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="nx">TextField</span> <span class="nx">source</span><span class="o">=</span><span class="s2">"body"</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="nx">BooleanField</span> <span class="nx">source</span><span class="o">=</span><span class="s2">"is_approved"</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="nx">ApproveButton</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="sr">/Datagrid</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/List&gt;</span><span class="err">;
</span></code></pre>
</div>

<p>Or, in the <code class="highlighter-rouge">&lt;Edit&gt;</code> page, as a <a href="./CreateEdit.html#actions">custom action</a>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/comments/CommentEditActions.js</span>
<span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">CardActions</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'material-ui/Card'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">ListButton</span><span class="p">,</span> <span class="nx">DeleteButton</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest/lib/mui'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">ApproveButton</span> <span class="nx">from</span> <span class="s1">'./ApproveButton'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">CommentEditActions</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">basePath</span><span class="p">,</span> <span class="nx">data</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">CardActions</span> <span class="nx">style</span><span class="o">=</span><span class="p">{{</span> <span class="nl">float</span><span class="p">:</span> <span class="s1">'right'</span> <span class="p">}}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">ApproveButton</span> <span class="nx">record</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">ListButton</span> <span class="nx">basePath</span><span class="o">=</span><span class="p">{</span><span class="nx">basePath</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">DeleteButton</span> <span class="nx">basePath</span><span class="o">=</span><span class="p">{</span><span class="nx">basePath</span><span class="p">}</span> <span class="nx">record</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/CardActions</span><span class="err">&gt;
</span><span class="p">);</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">ReviewEditActions</span><span class="p">;</span>

<span class="c1">// in src/comments/index.js</span>
<span class="kr">import</span> <span class="nx">ReviewEditActions</span> <span class="nx">from</span> <span class="s1">'./ReviewEditActions'</span><span class="p">;</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">CommentEdit</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="o">&lt;</span><span class="nx">Edit</span> <span class="p">{...</span><span class="nx">props</span><span class="p">}</span> <span class="nx">actions</span><span class="o">=</span><span class="p">{</span><span class="o">&lt;</span><span class="nx">ReviewEditActions</span> <span class="o">/&gt;</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="p">...</span>
    <span class="o">&lt;</span><span class="sr">/List&gt;</span><span class="err">;
</span></code></pre>
</div>

<h2 id="using-the-rest-client-instead-of-fetch">Using The REST Client Instead of Fetch</h2>

<p>The previous code uses <code class="highlighter-rouge">fetch()</code>, which means it has to make raw HTTP requests. The REST logic often requires a bit of HTTP plumbing to deal with query parameters, encoding, headers, body formatting, etc. It turns out you probably already have a function that maps from a REST request to an HTTP request: the <a href="./RestClients.html">REST Client</a>. So it’s a good idea to use this function instead of <code class="highlighter-rouge">fetch</code> - provided you have exported it:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/restClient.js</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">simpleRestClient</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>
<span class="kr">export</span> <span class="k">default</span> <span class="nx">simpleRestClient</span><span class="p">(</span><span class="s1">'http://Mydomain.com/api/'</span><span class="p">);</span>

<span class="c1">// in src/comments/ApproveButton.js</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">UPDATE</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">restClient</span> <span class="nx">from</span> <span class="s1">'../restClient'</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">ApproveButton</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">handleClick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">push</span><span class="p">,</span> <span class="nx">record</span><span class="p">,</span> <span class="nx">showNotification</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">updatedRecord</span> <span class="o">=</span> <span class="p">{</span> <span class="p">...</span><span class="nx">record</span><span class="p">,</span> <span class="na">is_approved</span><span class="p">:</span> <span class="kc">true</span> <span class="p">};</span>
        <span class="nx">restClient</span><span class="p">(</span><span class="nx">UPDATE</span><span class="p">,</span> <span class="s1">'comments'</span><span class="p">,</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="nx">record</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="na">data</span><span class="p">:</span> <span class="nx">updatedRecord</span> <span class="p">})</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">showNotification</span><span class="p">(</span><span class="s1">'Comment approved'</span><span class="p">);</span>
                <span class="nx">push</span><span class="p">(</span><span class="s1">'/comments'</span><span class="p">);</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
                <span class="nx">showNotification</span><span class="p">(</span><span class="s1">'Error: comment not approved'</span><span class="p">,</span> <span class="s1">'warning'</span><span class="p">)</span>
            <span class="p">});</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">&lt;</span><span class="nx">FlatButton</span> <span class="nx">label</span><span class="o">=</span><span class="s2">"Approve"</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">;
</span>    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>There you go: no more <code class="highlighter-rouge">fetch</code>. Just like <code class="highlighter-rouge">fetch</code>, the <code class="highlighter-rouge">restClient</code> returns a <code class="highlighter-rouge">Promise</code>. It’s signature is:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cm">/**
 * Execute the REST request and return a promise for a REST response
 *
 * @example
 * restClient(GET_ONE, 'posts', { id: 123 })
 *  =&gt; new Promise(resolve =&gt; resolve({ id: 123, title: "hello, world" }))
 *
 * @param {string} type Request type, e.g GET_LIST
 * @param {string} resource Resource name, e.g. "posts"
 * @param {Object} payload Request parameters. Depends on the action type
 * @returns {Promise} the Promise for a REST response
 */</span>
<span class="kr">const</span> <span class="nx">restClient</span> <span class="o">=</span> <span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">resource</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">Promise</span><span class="p">();</span>
</code></pre>
</div>

<p>As for the syntax of the various request types (<code class="highlighter-rouge">GET_LIST</code>, <code class="highlighter-rouge">GET_ONE</code>, <code class="highlighter-rouge">UPDATE</code>, etc.), head to the <a href="./RestClients.html#request-format">REST Client documentation</a> for more details.</p>

<h2 id="using-a-custom-action-creator">Using a Custom Action Creator</h2>

<p>Fetching data right inside the component is easy. But if you’re a Redux user, you might want to do it in a more idiomatic way - by dispatching actions. First, create your own action creator to replace the call to <code class="highlighter-rouge">restClient</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/comment/commentActions.js</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">UPDATE</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">COMMENT_APPROVE</span> <span class="o">=</span> <span class="s1">'COMMENT_APPROVE'</span><span class="p">;</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">commentApprove</span> <span class="o">=</span> <span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">basePath</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="nx">COMMENT_APPROVE</span><span class="p">,</span>
    <span class="na">payload</span><span class="p">:</span> <span class="p">{</span> <span class="nx">id</span><span class="p">,</span> <span class="na">data</span><span class="p">:</span> <span class="p">{</span> <span class="p">...</span><span class="nx">data</span><span class="p">,</span> <span class="na">is_approved</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span> <span class="p">},</span>
    <span class="na">meta</span><span class="p">:</span> <span class="p">{</span> <span class="na">resource</span><span class="p">:</span> <span class="s1">'comments'</span><span class="p">,</span> <span class="na">fetch</span><span class="p">:</span> <span class="nx">UPDATE</span><span class="p">,</span> <span class="na">cancelPrevious</span><span class="p">:</span> <span class="kc">false</span> <span class="p">},</span>
<span class="p">});</span>
</code></pre>
</div>

<p>This action creator takes advantage of admin-on-rest’s built in fetcher, which listens to actions with the <code class="highlighter-rouge">fetch</code> meta. Upon dispatch, this action will trigger the call to <code class="highlighter-rouge">restClient(UPDATE, 'comments')</code>, dispatch a <code class="highlighter-rouge">COMMENT_APPROVE_LOADING</code> action, then after receiving the response, dispatch either a <code class="highlighter-rouge">COMMENT_APPROVE_SUCCESS</code>, or a <code class="highlighter-rouge">COMMENT_APPROVE_FAILURE</code>.</p>

<p>To use the new action creator in the component, <code class="highlighter-rouge">connect</code> it:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/comments/ApproveButton.js</span>
<span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">PropTypes</span><span class="p">,</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">connect</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react-redux'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">FlatButton</span> <span class="nx">from</span> <span class="s1">'material-ui/FlatButton'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">commentApprove</span> <span class="nx">as</span> <span class="nx">commentApproveAction</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'./commentActions'</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">ApproveButton</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">handleClick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">commentApprove</span><span class="p">,</span> <span class="nx">record</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
        <span class="nx">commentApprove</span><span class="p">(</span><span class="nx">record</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">record</span><span class="p">);</span>
        <span class="c1">// how about push and showNotification?</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">&lt;</span><span class="nx">FlatButton</span> <span class="nx">label</span><span class="o">=</span><span class="s2">"Approve"</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">;
</span>    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ApproveButton</span><span class="p">.</span><span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">commentApprove</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">,</span>
    <span class="na">record</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">object</span><span class="p">,</span>
<span class="p">};</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">commentApprove</span><span class="p">:</span> <span class="nx">commentApproveAction</span><span class="p">,</span>
<span class="p">})(</span><span class="nx">ApproveButton</span><span class="p">);</span>
</code></pre>
</div>

<p>This works fine: when a user presses the “Approve” button, the API receives the <code class="highlighter-rouge">UPDATE</code> call, and that approves the comment. But it’s not possible to call <code class="highlighter-rouge">push</code> or <code class="highlighter-rouge">showNotification</code> in <code class="highlighter-rouge">handleClick</code> anymore. This is because <code class="highlighter-rouge">commentApprove()</code> returns immediately, whether the API call succeeds or not. How can you run a function only when the action succeeds?</p>

<h2 id="handling-side-effects-with-a-custom-saga">Handling Side Effects With a Custom Saga</h2>

<p><code class="highlighter-rouge">fetch</code>, <code class="highlighter-rouge">showNotification</code>, and <code class="highlighter-rouge">push</code> are called <em>side effects</em>. It’s a functional programming term that describes functions that do more than just returning a value based on their input. Admin-on-rest promotes a programming style where side effects are decoupled from the rest of the code, which has the benefit of making them testable.</p>

<p>In admin-on-rest, side effects are handled by Sagas. <a href="https://redux-saga.github.io/redux-saga/">Redux-saga</a> is a side effect library built for Redux, where side effects are defined by generator functions. This may sound complicated, but it’s not: Here is the generator function necessary to handle the side effects for the <code class="highlighter-rouge">COMMENT_APPROVE</code> action.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/comments/commentSaga.js</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">put</span><span class="p">,</span> <span class="nx">takeEvery</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'redux-saga/effects'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">push</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react-router-redux'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">showNotification</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>

<span class="kd">function</span><span class="o">*</span> <span class="nx">commentApproveSuccess</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">yield</span> <span class="nx">put</span><span class="p">(</span><span class="nx">showNotification</span><span class="p">(</span><span class="s1">'Comment approved'</span><span class="p">));</span>
    <span class="k">yield</span> <span class="nx">put</span><span class="p">(</span><span class="nx">push</span><span class="p">(</span><span class="s1">'/comments'</span><span class="p">));</span>
<span class="p">}</span>

<span class="kd">function</span><span class="o">*</span> <span class="nx">commentApproveFailure</span><span class="p">({</span> <span class="nx">error</span> <span class="p">})</span> <span class="p">{</span>
    <span class="k">yield</span> <span class="nx">put</span><span class="p">(</span><span class="nx">showNotification</span><span class="p">(</span><span class="s1">'Error: comment not approved'</span><span class="p">,</span> <span class="s1">'warning'</span><span class="p">));</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span><span class="o">*</span> <span class="nx">commentSaga</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">yield</span> <span class="p">[</span>
        <span class="nx">takeEvery</span><span class="p">(</span><span class="s1">'COMMENT_APPROVE_SUCCESS'</span><span class="p">,</span> <span class="nx">commentApproveSuccess</span><span class="p">),</span>
        <span class="nx">takeEvery</span><span class="p">(</span><span class="s1">'COMMENT_APPROVE_FAILURE'</span><span class="p">,</span> <span class="nx">commentApproveFailure</span><span class="p">),</span>
    <span class="p">];</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Let’s explain all of that, starting with the final <code class="highlighter-rouge">commentSaga</code> generator function. A <a href="http://exploringjs.com/es6/ch_generators.html">generator function</a> (denoted by the <code class="highlighter-rouge">*</code> in the function name) gets paused on statements called by <code class="highlighter-rouge">yield</code> - until the yielded statement returns. <code class="highlighter-rouge">yield []</code> yields two commands <a href="https://redux-saga.github.io/redux-saga/docs/advanced/RunningTasksInParallel.html">in parallel</a>. <code class="highlighter-rouge">yield takeEvery([ACTION_NAME], callback)</code> executes the provided callback <a href="https://redux-saga.github.io/redux-saga/docs/basics/UsingSagaHelpers.html">every time the related action is called</a>. To summarize, this will execute <code class="highlighter-rouge">commentApproveSuccess</code> when the fetch initiated by <code class="highlighter-rouge">commentApprove()</code> succeeds, and <code class="highlighter-rouge">commentApproveFailure</code> otherwise.</p>

<p>As for <code class="highlighter-rouge">commentApproveSuccess</code> and <code class="highlighter-rouge">commentApproveFailure</code>, they simply dispatch (<code class="highlighter-rouge">put()</code>) the side effects - the same side effects as in the initial version.</p>

<p>To use this saga, pass it in the <code class="highlighter-rouge">customSagas</code> props of the <code class="highlighter-rouge">&lt;Admin&gt;</code> component:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/App.js</span>
<span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">Admin</span><span class="p">,</span> <span class="nx">Resource</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>

<span class="kr">import</span> <span class="p">{</span> <span class="nx">CommentList</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'./comments'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">commentSaga</span> <span class="nx">from</span> <span class="s1">'./comments/commentSaga'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Admin</span> <span class="nx">customSagas</span><span class="o">=</span><span class="p">{[</span> <span class="nx">commentSaga</span> <span class="p">]}</span> <span class="nx">restClient</span><span class="o">=</span><span class="p">{</span><span class="nx">jsonServerRestClient</span><span class="p">(</span><span class="s1">'http://jsonplaceholder.typicode.com'</span><span class="p">)}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Resource</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"comments"</span> <span class="nx">list</span><span class="o">=</span><span class="p">{</span><span class="nx">CommentList</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/Admin</span><span class="err">&gt;
</span><span class="p">);</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre>
</div>

<p>With this code, approving a review now displays the correct notification, and redirects to the comment list. And the side effects are <a href="https://redux-saga.github.io/redux-saga/docs/introduction/BeginnerTutorial.html#making-our-code-testable">testable</a>, too.</p>

<h2 id="bonus-optimistic-rendering">Bonus: Optimistic Rendering</h2>

<p>In this example, after clicking on the “Approve” button, users are redirected to the comments list. Admin-on-rest then fetches the <code class="highlighter-rouge">/comments</code> resource to grab the list of updated comments from the server. But admin-on-rest doesn’t wait for the response to this call to display the list of comments. In fact, it has an internal instance pool that is kept during navigation, and uses it to render the screen before the API calls are over - it’s called <em>optimistic rendering</em>.</p>

<p>As the custom <code class="highlighter-rouge">COMMENT_APPROVE</code> action contains the <code class="highlighter-rouge">fetch: UPDATE</code> meta, admin-on-rest will automatically update its instance pool with the response. That means that the initial rendering (before the <code class="highlighter-rouge">GET /comments</code> response arrives) will show the approved comment!</p>

<p>The fact that admin-on-rest updates the instance pool if you use custom actions with the <code class="highlighter-rouge">fetch</code> meta should be another motivation to avoid using raw <code class="highlighter-rouge">fetch</code>.</p>

<h2 id="using-a-custom-reducer">Using a Custom Reducer</h2>

<p>In addition to triggering REST calls, you may want to store the effect of your own actions in the application state. For instance, if you want to display a widget showing the current exchange rate for the bitcoin, you might need the following action:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/bitcoinRateReceived.js</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">BITCOIN_RATE_RECEIVED</span> <span class="o">=</span> <span class="s1">'BITCOIN_RATE_RECEIVED'</span><span class="p">;</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">bitcoinRateReceived</span> <span class="o">=</span> <span class="p">(</span><span class="nx">rate</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="nx">BITCOIN_RATE_RECEIVED</span><span class="p">,</span>
    <span class="na">payload</span><span class="p">:</span> <span class="p">{</span> <span class="nx">rate</span> <span class="p">},</span>
<span class="p">});</span>
</code></pre>
</div>

<p>This action can be triggered on mount by the following component:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/BitCoinRate.js</span>
<span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">PropTypes</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">connect</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react-redux'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">bitcoinRateReceived</span> <span class="nx">as</span> <span class="nx">bitcoinRateReceivedAction</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'./bitcoinRateReceived'</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">BitCoinRate</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">componentWillMount</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://blockchain.info/fr/ticker'</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">rates</span> <span class="o">=&gt;</span> <span class="nx">rates</span><span class="p">.</span><span class="nx">USD</span><span class="p">[</span><span class="s1">'15m'</span><span class="p">])</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">bitcoinRateReceived</span><span class="p">)</span> <span class="c1">// dispatch action when the response is received</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">rate</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
        <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Current</span> <span class="nx">bitcoin</span> <span class="nx">value</span><span class="err">:</span> <span class="p">{</span><span class="nx">rate</span><span class="p">}</span><span class="nx">$</span><span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">BitCoinRate</span><span class="p">.</span><span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">bitcoinRateReceived</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">,</span>
    <span class="na">rate</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span><span class="p">,</span>
<span class="p">};</span>

<span class="kr">const</span> <span class="nx">mapStateToProps</span> <span class="o">=</span> <span class="nx">state</span> <span class="o">=&gt;</span> <span class="p">({</span> <span class="na">rate</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">bitcoinRate</span> <span class="p">});</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span><span class="nx">mapStateToProps</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">bitcoinRateReceived</span><span class="p">:</span> <span class="nx">bitcoinRateReceivedAction</span><span class="p">,</span>
<span class="p">})(</span><span class="nx">BitCoinRate</span><span class="p">);</span>
</code></pre>
</div>

<p>In order to put the rate passed to <code class="highlighter-rouge">bitcoinRateReceived()</code> into the Redux store, you’ll need a reducer:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/rateReducer.js</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">BITCOIN_RATE_RECEIVED</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'./bitcoinRateReceived'</span><span class="p">;</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="p">(</span><span class="nx">previousState</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">{</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">payload</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">BITCOIN_RATE_RECEIVED</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">payload</span><span class="p">.</span><span class="nx">rate</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">previousState</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Now the question is: How can you put this reducer in the <code class="highlighter-rouge">&lt;Admin&gt;</code> app? Simple: use the <code class="highlighter-rouge">customReducers</code> props:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/App.js</span>
<span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">Admin</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>

<span class="kr">import</span> <span class="nx">rate</span> <span class="nx">from</span> <span class="s1">'./rateReducer'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Admin</span> <span class="nx">customReducers</span><span class="o">=</span><span class="p">{{</span> <span class="nx">rate</span> <span class="p">}}</span> <span class="nx">restClient</span><span class="o">=</span><span class="p">{</span><span class="nx">jsonServerRestClient</span><span class="p">(</span><span class="s1">'http://jsonplaceholder.typicode.com'</span><span class="p">)}</span><span class="o">&gt;</span>
        <span class="p">...</span>
    <span class="o">&lt;</span><span class="sr">/Admin</span><span class="err">&gt;
</span><span class="p">);</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre>
</div>

<p><strong>Tip</strong>: You can avoid storing data in the Redux state by storing data in a component state instead. It’s much less complicated to deal with, and more performant, too. Use the global state only when you really need to.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Which style should you choose for your own action buttons?</p>

<p>The first version (with <code class="highlighter-rouge">fetch</code>) is perfectly fine, and if you’re not into unit testing your components, or decoupling side effects from pure functions, then you can stick with it without problem.</p>

<p>On the other hand, if you want to promote reusability, separation of concerns, adhere to admin-on-rest’s coding standards, and if you know enough Redux and Saga, use the final version.</p>


                                </section>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>

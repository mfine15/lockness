<!DOCTYPE HTML>
<html lang="en-US">
    <head>
        <title>Admin-on-rest - Authentication</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/syntax.css">
    </head>
    <body>
        <div class="book with-summary font-size-2 font-family-1">
            <div class="book-summary">
                <nav role="navigation">
                    <ul class="summary">
                        <li class="header">Table of Contents</li>
                        <li class="chapter ">
                            <a href="./index.html">
                                <b>1.</b> Read Me
                            </a>
                        </li>
                        <li class="chapter ">
                            <a href="./Tutorial.html">
                                <b>2.</b> Tutorial
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#installation">Installation</a>
                                </li>
                                <li class="chapter">
                                    <a href="#making-contact-with-the-api">Making Contact With The API</a>
                                </li>
                                <li class="chapter">
                                    <a href="#field-types">Field Types</a>
                                </li>
                                <li class="chapter">
                                    <a href="#relationships">Relationships</a>
                                </li>
                                <li class="chapter">
                                    <a href="#creation-and-edition">Creation and Edition</a>
                                </li>
                                <li class="chapter">
                                    <a href="#deletion">Deletion</a>
                                </li>
                                <li class="chapter">
                                    <a href="#filters">Filters</a>
                                </li>
                                <li class="chapter">
                                    <a href="#customizing-the-menu-icons">Customizing the Menu Icons</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-custom-home-page">Using a Custom Home Page</a>
                                </li>
                                <li class="chapter">
                                    <a href="#adding-a-login-page">Adding a Login Page</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-another-rest-dialect">Using Another REST Dialect</a>
                                </li>
                                <li class="chapter">
                                    <a href="#conclusion">Conclusion</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./RestClients.html">
                                <b>3.</b> REST Clients
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#simple-rest">Simple REST</a>
                                </li>
                                <li class="chapter">
                                    <a href="#jsonserver-rest">JSON Server REST</a>
                                </li>
                                <li class="chapter">
                                    <a href="#adding-custom-headers">Adding Custom Headers</a>
                                </li>
                                <li class="chapter">
                                    <a href="#third-party-clients">Third-Party Clients</a>
                                </li>
                                <li class="chapter">
                                    <a href="#writing-your-own-rest-client">Writing your own REST client</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./AdminResource.html">
                                <b>4.</b> Admin and Resource Components
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#the-admin-component"><code>&lt;Admin&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#the-resource-component"><code>&lt;Resource&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-admin-on-rest-without-admin-and-resource">Not using <code>&lt;Admin&gt;</code> and <code>&lt;Resource&gt;</code></a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./List.html">
                                <b>5.</b> The <code>&lt;List&gt;</code> View
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#the-list-component"><code>&lt;List&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#the-datagrid-component"><code>&lt;Datagrid&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#the-singlefieldlist-component"><code>&lt;SingleFieldList&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-custom-iterator">Using a Custom Iterator</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./Fields.html">
                                <b>6.</b> Field Components
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#booleanfield"><code>&lt;BooleanField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#chipfield"><code>&lt;ChipField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#datefield"><code>&lt;DateField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#emailfield"><code>&lt;EmailField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#functionfield"><code>&lt;FunctionField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#numberfield"><code>&lt;NumberField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#referencefield"><code>&lt;ReferenceField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#referencemanyfield"><code>&lt;ReferenceManyField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#richtextfield"><code>&lt;RichTextField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#textfield"><code>&lt;TextField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#urlfield"><code>&lt;UrlField&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#styling-fields">Styling Fields</a>
                                </li>
                                <li class="chapter">
                                    <a href="#writing-your-own-field-component">Writing your own field component</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./CreateEdit.html">
                                <b>7.</b> The <code>&lt;Create&gt;</code> and <code>&lt;Edit&gt;</code> Views
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#the-create-and-edit-components"><code>&lt;Create&gt;</code>, <code>&lt;Edit&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#page-title">Page Title</a>
                                </li>
                                <li class="chapter">
                                    <a href="#actions">Actions</a>
                                </li>
                                <li class="chapter">
                                    <a href="#the-simpleform-component"><code>&lt;SimpleForm&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#the-tabbedform-component"><code>&lt;TabbedForm&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#default-values">Default Values</a>
                                </li>
                                <li class="chapter">
                                    <a href="#validation">Validation</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./Inputs.html">
                                <b>8.</b> Input Components
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#autocompleteinput"><code>&lt;AutocompleteInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#booleaninput-and-nullablebooleaninput"><code>&lt;BooleanInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#dateinput"><code>&lt;DateInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#disabledinput"><code>&lt;DisabledInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#longtextinput"><code>&lt;LongTextInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#numberinput"><code>&lt;NumberInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#radiobuttongroupinput"><code>&lt;RadioButtonGroupInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#referenceinput"><code>&lt;ReferenceInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#richtextinput"><code>&lt;RichTextInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#selectinput"><code>&lt;SelectInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#textinput"><code>&lt;TextInput&gt;</code></a>
                                </li>
                                <li class="chapter">
                                    <a href="#writing-your-own-input-component">Writing your own input component</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter active">
                            <a href="./Authentication.html">
                                <b>9.</b> Authentication
                            </a>
                            <ul class="articles" >
                                <li class="chapter">
                                    <a href="#configuring-the-auth-client">Configuring the Auth Client</a>
                                </li>
                                <li class="chapter">
                                    <a href="#sending-credentials-to-the-rest-api">Sending Credentials to the REST API</a>
                                </li>
                                <li class="chapter">
                                    <a href="#adding-a-logout-button">Adding a Logout Button</a>
                                </li>
                                <li class="chapter">
                                    <a href="#checking-credentials-during-navigation">Checking Credentials During Navigation</a>
                                </li>
                                <li class="chapter">
                                    <a href="#customizing-the-login-and-logout-components">Customizing The Login and Logout Components</a>
                                </li>
                            </ul>
                        </li>
                        <li class="chapter ">
                            <a href="./Theming.html">
                                <b>10.</b> Theming
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#overriding-a-component-style">Overriding A Component Style</a>
                                </li>
                                <li class="chapter">
                                    <a href="#conditional-formatting">Conditional Formatting</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-predefined-theme">Using a Predefined Theme</a>
                                </li>
                                <li class="chapter">
                                    <a href="#writing-a-custom-theme">Writing a Custom Theme</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-custom-layout">Using a Custom Layout</a>
                                </li>
                            </ul>
                        </li>

                        <li class="chapter ">
                            <a href="./Actions.html">
                                <b>11.</b> Writing Actions
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#the-simple-way">The Simple Way</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-the-rest-client-instead-of-fetch">Using The REST Client</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-custom-action-creator">Using a Custom Action Creator</a>
                                </li>
                                <li class="chapter">
                                    <a href="#handling-side-effects-with-a-custom-saga">Handling Side Effects With a Custom Saga</a>
                                </li>
                                <li class="chapter">
                                    <a href="#bonus-optimistic-rendering">Bonus: Optimistic Rendering</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-a-custom-reducer">Using a Custom Reducer</a>
                                </li>
                            </ul>
                        </li>

                        <li class="chapter ">
                            <a href="./Translation.html">
                                <b>12.</b> Translation
                            </a>
                            <ul class="articles" style="display:none">
                                <li class="chapter">
                                    <a href="#changing-locale">Changing Locale</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-the-browser-locale">Using Browser Locale</a>
                                </li>
                                <li class="chapter">
                                    <a href="#translation-messages">Translation Messages</a>
                                </li>
                                <li class="chapter">
                                    <a href="#overriding-existing-translations">Overriding Existing Translations</a>
                                </li>
                                <li class="chapter">
                                    <a href="#translating-your-resources">Translating Your Resources</a>
                                </li>
                                <li class="chapter">
                                    <a href="#translating-your-own-components">Translating Your Own Components</a>
                                </li>
                                <li class="chapter">
                                    <a href="#using-specific-polyglot-features">Using Specific Polyglot Features</a>
                                </li>
                            </ul>
                        </li>

                        <li class="chapter ">
                            <a href="./CustomApp.html">
                                <b>13.</b> Including in Another App
                            </a>
                        </li>

                        <li class="chapter ">
                            <a href="./Reference.html">
                                <b>14.</b> Reference
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
            <div class="book-body">
                <div class="body-inner">
                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">

                            <div id="book-search-results">
                                <div class="search-noresults">

                                <section class="normal markdown-section">

                                <h1 id="authentication">Authentication</h1>

<p><img src="./img/login.gif" alt="Logout button" /></p>

<p>Admin-on-rest lets you secure your admin app with the authentication strategy of your choice. Since there are many different possible strategies (Basic Auth, JWT, OAuth, etc.), admin-on-rest simply provides hooks to execute your own authentication code.</p>

<p>By default, an admin-on-rest app doesn’t require authentication. But if the REST API ever returns a 401 (Unauthorized) or a 403 (Forbidden) response, then the user is redirected to the <code class="highlighter-rouge">/login</code> route. You have nothing to do - it’s already built in.</p>

<h2 id="configuring-the-auth-client">Configuring the Auth Client</h2>

<p>By default, the <code class="highlighter-rouge">/login</code> route renders a special component called <code class="highlighter-rouge">Login</code>, which displays a login form asking for username and password.</p>

<p><img src="./img/login-form.png" alt="Default Login Form" /></p>

<p>What this form does upon submission depends on the <code class="highlighter-rouge">authClient</code> prop of the <code class="highlighter-rouge">&lt;Admin&gt;</code> component. This function receives authentication requests <code class="highlighter-rouge">(type, params)</code>, and should return a Promise. <code class="highlighter-rouge">Login</code> calls <code class="highlighter-rouge">authClient</code> with the <code class="highlighter-rouge">AUTH_LOGIN</code> type, and <code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="err">login,</span><span class="w"> </span><span class="err">password</span><span class="w"> </span><span class="p">}</span></code> as parameters. It’s the ideal place to authenticate the user, and store their credentials.</p>

<p>For instance, to query an authentication route via HTTPS and store the credentials (a token) in local storage, configure <code class="highlighter-rouge">authClient</code> as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/authClient.js</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">AUTH_LOGIN</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">AUTH_LOGIN</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">password</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">params</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Request</span><span class="p">(</span><span class="s1">'https://mydomain.com/authenticate'</span><span class="p">,</span> <span class="p">{</span>
            <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
            <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">password</span> <span class="p">}),</span>
            <span class="na">headers</span><span class="p">:</span> <span class="k">new</span> <span class="nx">Headers</span><span class="p">({</span> <span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span> <span class="p">}),</span>
        <span class="p">})</span>
        <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">&lt;</span> <span class="mi">200</span> <span class="o">||</span> <span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">&gt;=</span> <span class="mi">300</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(({</span> <span class="nx">token</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'token'</span><span class="p">,</span> <span class="nx">token</span><span class="p">)</span>
            <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>Tip</strong>: It’s a good idea to store credentials in <code class="highlighter-rouge">localStorage</code>, to avoid reconnection when opening a new browser tab. But this makes your application <a href="http://www.redotheweb.com/2015/11/09/api-security.html">open to XSS attacks</a>, so you’d better double down on security, and add an <code class="highlighter-rouge">httpOnly</code> cookie on the server side, too.</p>

<p>Then, pass this client to the <code class="highlighter-rouge">&lt;Admin&gt;</code> component:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/App.js</span>
<span class="kr">import</span> <span class="nx">authClient</span> <span class="nx">from</span> <span class="s1">'./authClient'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Admin</span> <span class="nx">authClient</span><span class="o">=</span><span class="p">{</span><span class="nx">authClient</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="p">...</span>
    <span class="o">&lt;</span><span class="sr">/Admin</span><span class="err">&gt;
</span><span class="p">);</span>
</code></pre>
</div>

<p>Upon receiving a 403 response, the admin app shows the Login page. <code class="highlighter-rouge">authClient</code> is now called when the user submits the login form. Once the promise resolves, the login form redirects to the previous page, or to the admin index if the user just arrived.</p>

<h2 id="sending-credentials-to-the-rest-api">Sending Credentials to the REST API</h2>

<p>To use the credentials when calling REST API routes, you have to tweak, this time, the <code class="highlighter-rouge">restClient</code>. As explained in the <a href="RestClients.html#adding-custom-headers">REST client documentation</a>, <code class="highlighter-rouge">simpleRestClient</code> and <code class="highlighter-rouge">jsonServerRestClient</code> take an <code class="highlighter-rouge">httpClient</code> as second parameter. That’s the place where you can change request headers, cookies, etc.</p>

<p>For instance, to pass the token obtained during login as an <code class="highlighter-rouge">Authorization</code> header, configure the REST client as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="p">{</span> <span class="nx">simpleRestClient</span><span class="p">,</span> <span class="nx">fetchUtils</span><span class="p">,</span> <span class="nx">Admin</span><span class="p">,</span> <span class="nx">Resource</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">httpClient</span> <span class="o">=</span> <span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">headers</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">options</span><span class="p">.</span><span class="nx">headers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Headers</span><span class="p">({</span> <span class="na">Accept</span><span class="p">:</span> <span class="s1">'application/json'</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">'token'</span><span class="p">)</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'Authorization'</span><span class="p">,</span> <span class="err">`</span><span class="nx">Bearer</span> <span class="nx">$</span><span class="p">{</span><span class="nx">token</span><span class="p">}</span><span class="err">`</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">fetchUtils</span><span class="p">.</span><span class="nx">fetchJson</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">}</span>
<span class="kr">const</span> <span class="nx">restClient</span> <span class="o">=</span> <span class="nx">simpleRestClient</span><span class="p">(</span><span class="s1">'http://localhost:3000'</span><span class="p">,</span> <span class="nx">httpClient</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Admin</span> <span class="nx">restClient</span><span class="o">=</span><span class="p">{</span><span class="nx">restClient</span><span class="p">}</span> <span class="nx">authClient</span><span class="o">=</span><span class="p">{</span><span class="nx">authClient</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="p">...</span>
    <span class="o">&lt;</span><span class="sr">/Admin</span><span class="err">&gt;
</span><span class="p">);</span>
</code></pre>
</div>

<p>If you have a custom REST client, don’t forget to add credentials yourself.</p>

<h2 id="adding-a-logout-button">Adding a Logout Button</h2>

<p>If you provide an <code class="highlighter-rouge">authClient</code> prop to <code class="highlighter-rouge">&lt;Admin&gt;</code>, admin-on-rest displays a logout button in the sidebar. When the user clicks on the logout button, this calls the <code class="highlighter-rouge">authClient</code> with the <code class="highlighter-rouge">AUTH_LOGOUT</code> type. When resolved, the user gets redirected to the login page.</p>

<p>For instance, to remove the token from local storage upon logout:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/authClient.js</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">AUTH_LOGIN</span><span class="p">,</span> <span class="nx">AUTH_LOGOUT</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">AUTH_LOGIN</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">AUTH_LOGOUT</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s1">'token'</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
<span class="p">};</span>
</code></pre>
</div>

<p><img src="./img/logout.gif" alt="Logout button" /></p>

<p>The <code class="highlighter-rouge">authClient</code> is also a good place to notify the authentication API that the user credentials are no longer valid after logout.</p>

<h2 id="checking-credentials-during-navigation">Checking Credentials During Navigation</h2>

<p>Admin-on-rest redirects to the login page whenever a REST response uses a 403 status code. But that’s usually not enough, because admin-on-rest keeps data on the client side, and could display stale data while contacting the server - even after the credentials are no longer valid.</p>

<p>Fortunately, each time the user navigates, admin-on-rest calls the <code class="highlighter-rouge">authClient</code> with the <code class="highlighter-rouge">AUTH_CHECK</code> type, so it’s the ideal place to check for credentials.</p>

<p>For instance, to check for the existence of the token in local storage:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/authClient.js</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">AUTH_LOGIN</span><span class="p">,</span> <span class="nx">AUTH_LOGOUT</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">AUTH_LOGIN</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">AUTH_LOGOUT</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">AUTH_CHECK</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">'username'</span><span class="p">)</span> <span class="p">?</span> <span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">()</span> <span class="p">:</span> <span class="nx">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="s1">'Unkown method'</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
</div>

<p>If the promise is rejected, admin-on-rest redirects to the <code class="highlighter-rouge">/login</code> page.</p>

<p><strong>Tip</strong>: For the <code class="highlighter-rouge">AUTH_CHECK</code> call, the <code class="highlighter-rouge">params</code> argument contains the <code class="highlighter-rouge">resource</code> name, so you can implement different checks for different resources:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/authClient.js</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">AUTH_LOGIN</span><span class="p">,</span> <span class="nx">AUTH_LOGOUT</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'admin-on-rest'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">AUTH_LOGIN</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">AUTH_LOGOUT</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">AUTH_CHECK</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">resource</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">params</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">resource</span> <span class="o">===</span> <span class="s1">'posts'</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// check credentials for the posts resource</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">resource</span> <span class="o">===</span> <span class="s1">'comments'</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// check credentials for the comments resource</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="s1">'Unkown method'</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
</div>

<p><strong>Tip</strong>: The <code class="highlighter-rouge">authClient</code> can only be called with <code class="highlighter-rouge">AUTH_LOGIN</code>, <code class="highlighter-rouge">AUTH_LOGOUT</code>, or <code class="highlighter-rouge">AUTH_CHECK</code>; that’s why the final return is a rejected promise.</p>

<h2 id="customizing-the-login-and-logout-components">Customizing The Login and Logout Components</h2>

<p>Using <code class="highlighter-rouge">authClient</code> and <code class="highlighter-rouge">checkCredentials</code> is enough to implement a full-featured authorization system if the authentication relies on a username and password.</p>

<p>But what if you want to use an email instead of a username? What if you want to use a Single-Sign-On (SSO) with a third-party authentication service? What if you want to use two-factor authentication?</p>

<p>For all these cases, it’s up to you to implement your own <code class="highlighter-rouge">LoginPage</code> component, which will be displayed under the <code class="highlighter-rouge">/login</code> route instead of the default username/password form, and your own <code class="highlighter-rouge">LogoutButton</code> component, which will be displayed in the sidebar. Pass both these components to the <code class="highlighter-rouge">&lt;Admin&gt;</code> component:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in src/App.js</span>
<span class="kr">import</span> <span class="nx">MyLoginPage</span> <span class="nx">from</span> <span class="s1">'./MyLoginPage'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">MyLogoutButton</span> <span class="nx">from</span> <span class="s1">'./MyLogoutButton'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Admin</span> <span class="nx">loginPage</span><span class="o">=</span><span class="p">{</span><span class="nx">MyLoginPage</span><span class="p">}</span> <span class="nx">logoutButton</span><span class="o">=</span><span class="p">{</span><span class="nx">MyLogoutButton</span><span class="p">}</span><span class="o">&gt;</span>
    <span class="p">...</span>
    <span class="o">&lt;</span><span class="sr">/Admin</span><span class="err">&gt;
</span><span class="p">);</span>
</code></pre>
</div>

<p><strong>Tip</strong>: When setting the <code class="highlighter-rouge">loginPage</code> and <code class="highlighter-rouge">logoutButton</code> props, you no longer need the <code class="highlighter-rouge">authClient</code> method, since it is only passed to the default <code class="highlighter-rouge">Login</code> and <code class="highlighter-rouge">Logout</code> components. That means your custom login and logout components must implement their own authentication client.</p>

<p><strong>Tip</strong>: If you want to use Redux and Saga to handle credentials and authorization, you will need to register  <a href="./AdminResource.html#customreducers">custom reducers</a> and <a href="./AdminResource.html#customsagas">custom sagas</a> in the <code class="highlighter-rouge">&lt;Admin&gt;</code> component.</p>


                                </section>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
